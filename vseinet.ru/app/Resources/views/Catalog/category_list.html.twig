{% extends "layout.html.twig" %}

{% block pageTitle %}{% if category.pageTitle %}{{ category.pageTitle }}{% else %}Купить {{ category.name }} в г.{{ app.geoCity.name }}, цена{% endif %} в интернет-магазине Vseinet.ru{% endblock %}

{% block pageDescription %}{% if category.pageDescription %}{{ category.pageDescription }}{% else %}В каталоге {{ category.name }} вы найдёте цены, отзывы, характеристики, описания и фотографии товаров. Наши цены вас порадуют!{% endif %}{% endblock %}

{% block content %}
    <section id="catalog">
        <ul class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
                <a itemprop="item" href="{{ path('catalog') }}" title="Каталог"><span itemprop="name">Каталог</span></a>
                <meta itemprop="position" content="1" />
            </li>
            {% for key, link in category.breadcrumbs %}
                <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
                    <a itemprop="item" href="{% if link.sefUrl %}{{ path('catalog_category_sef', { slug: link.sefUrl }) }}{% else %}{{ path('catalog_category', { id: link.id }) }}{% endif %}" title="{{ link.name }}"><span itemprop="name">{{ link.name }}</span></a>
                    <meta itemprop="position" content="{{ key + 2 }}" />
                </li>
            {% endfor %}
        </ul>
        <h1 class="inline">{{ category.name }}</h1>
        {% if app.userIsEmployee %}
            <a
                href="{{ path('authority', { targetUrl: ['/admin/productPricetags?listType=category&ids[]=', category.id]|join}) }}"
                target="_blank"
                class="pricetag"
                title="Печать ценников">
                </a>
        {% endif %}
        {% if category.description %}
            <section class="content htx htx_catalog">{{ category.description|raw }}</section>
        {% endif %}
        <div class="wrapper{% if category.description %} category-description-wrapper{% endif %}">
            {% for subcategory in subcategories %}
                <div class="category">
                    <a href="{% if subcategory.sefUrl %}{{ path('catalog_category_sef', { slug: subcategory.sefUrl }) }}{% else %}{{ path('catalog_category', { id: subcategory.id }) }}{% endif %}" class="image">
                        <img src="{{ subcategory|image(constant('AppBundle\\Enum\\BaseProductImage::SIZE_MD')) }}" alt="Превью категории {{ subcategory.name }}" />
                    </a>
                    <div class="title">
                        <a href="{% if subcategory.sefUrl %}{{ path('catalog_category_sef', { slug: subcategory.sefUrl }) }}{% else %}{{ path('catalog_category', { id: subcategory.id }) }}{% endif %}">{{ subcategory.name }}</a>
                        <small>
                            {{ subcategory.countProducts|number_format }}
                            {{ subcategory.countProducts|declension('товар;товара;товаров') }}
                        </small>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
{% endblock %}
